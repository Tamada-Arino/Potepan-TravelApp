<%= render "shared/search_form" %>

<div class="d-flex justify-content-between">
  <%= link_to"戻る", 'javascript:history.back()', class: "h4" %>
  <%if  user_signed_in? %>
    <% if current_user.id == @room.user_id %>
      <%= link_to"編集", [:edit, @room], class: "h4" %>
    <% end %>
  <% end %>
</div>
<div class="d-flex">
  <div>
    <% if @room.image.attached? %>
      <%= image_tag @room.image %>
    <% else %>
      <%= image_tag 'default-image.png' %>
    <% end %>
  </div>
  <div>
    <p class="h3"><%= @room.name %></p>
    <p class="text-secondary"><%= @room.address %></p>
    <p>¥<%= @room.price.to_s(:delimited) %></p>
    <%= @room.introduction %>
  </div>
</div>

<div class="bg-light">
  <table>
    <%= form_with model: @reservation, url: reservations_confirm_path , method: :post do |f| %>
      <tr>
        <th class="h3">予約する</th>
      </tr>
      <tr>
        <th><%= f.label :check_in,"チェックイン" %></th>
        <td><%= f.date_field :check_in%></td>
        <td>
          <% if @reservation.errors.include?(:check_in) %>
            <p style="color: red;"><%= @reservation.errors.full_messages_for(:check_in).first %>
          <% end %>
        </td>
      </tr>
      <tr>
        <th><%= f.label :check_out, "チェックアウト" %></th>
        <td><%= f.date_field :check_out %></td>
        <td>
          <% if @reservation.errors.include?(:check_out) %>
            <p style="color: red;"><%= @reservation.errors.full_messages_for(:check_out).first %>
          <% end %>
        </td>
      </tr>
      <tr>
        <th><%= f.label :people, "人数" %></th>
        <td><%= f.number_field :people %></td>
        <td>
          <% if @reservation.errors.include?(:people) %>
            <p style="color: red;"><%= @reservation.errors.full_messages_for(:people).first %>
          <% end %>
        </td>
      </tr>
      <%= f.hidden_field :room_id, value: @room.id %>
      <tr>
        <td colspan="2">
          <% if user_signed_in? %>
            <%= f.hidden_field :user_id, value: current_user.id %>
            <%= f.submit "予約する", class: "btn btn-primary w-100" %>
          <% else %>
            <%= link_to"ログイン", new_user_session_path, class: "btn btn-primary w-100" %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </table>
</div>